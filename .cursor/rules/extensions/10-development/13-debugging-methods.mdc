---
alwaysApply: ${cursor.file.path.includes("troubleshoot") || cursor.file.content.includes("debug")}
---


# –ü—Ä–∞–≤–∏–ª–æ 06-1: –ú–µ—Ç–æ–¥—ã –∏ —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥ –∫ –æ—Ç–ª–∞–¥–∫–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π

## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞
–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥ –∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º –≤ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è—Ö rpi-image-gen.

## –ú–µ—Ç–æ–¥—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ üî¥ –û–í–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï

### 1. –í–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ üî¥ –û–í–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï
```bash
# –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
rpi-image-gen build -c config.yaml -v --debug

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
rpi-image-gen build -c config.yaml --keep-tmp

# –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ö—É–∫–æ–≤
rpi-image-gen build -c config.yaml --trace-hooks

# –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
rpi-image-gen build -c config.yaml --perf-report

# –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
rpi-image-gen build -c config.yaml --deps-report
```

### 2. –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ üî¥ –û–í–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï
```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
tail -f /tmp/rpi-image-gen-*/build.log | grep -i error

# –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–∞–ø–æ–≤
rpi-image-gen build -c config.yaml --timing-report

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
env | grep IGconf_ | sort

# –ü–æ–∏—Å–∫ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –æ—à–∏–±–æ–∫
grep -r "ERROR\|WARNING\|FAILED" /tmp/rpi-image-gen-*/ | head -20

# –ê–Ω–∞–ª–∏–∑ —Ä–∞–∑–º–µ—Ä–∞ –ª–æ–≥–æ–≤
du -sh /tmp/rpi-image-gen-*/logs/
```

### 3. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –æ—Ç–ª–∞–¥–∫–∞ üî¥ –û–í–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï
```bash
# –ó–∞–ø—É—Å–∫ –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ
rpi-image-gen build -c config.yaml --interactive

# –®–∞–≥–æ–≤–∞—è –æ—Ç–ª–∞–¥–∫–∞ —Ö—É–∫–æ–≤
rpi-image-gen build -c config.yaml --step-through-hooks

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ø–∞–∫–µ—Ç–æ–≤
apt-cache depends package-name
apt-cache rdepends package-name

# –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±–µ–∑ —Å–±–æ—Ä–∫–∏
rpi-image-gen config --validate config.yaml

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
rpi-image-gen layer --test layer-name
```

## –°–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥ –∫ –æ—Ç–ª–∞–¥–∫–µ üî¥ –û–í–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï

### –≠—Ç–∞–ø 1: –°–±–æ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
```bash
#!/bin/bash
# –°–∫—Ä–∏–ø—Ç —Å–±–æ—Ä–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

collect_diagnostic_info() {
    local output_dir="/tmp/extension-diagnostic-$(date +%Y%m%d-%H%M%S)"
    mkdir -p "$output_dir"

    echo "–°–±–æ—Ä –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ $output_dir"

    # –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
    uname -a > "$output_dir/system-info.txt"
    lsb_release -a >> "$output_dir/system-info.txt" 2>/dev/null || true

    # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ rpi-image-gen
    rpi-image-gen --version > "$output_dir/rpi-image-gen-version.txt" 2>&1 || true

    # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
    env | grep -E "(IGconf_|RPI_|DOCKER_)" | sort > "$output_dir/environment-vars.txt"

    # –°–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
    dpkg -l | grep -E "(rpi|raspberry|mmdebstrap)" > "$output_dir/installed-packages.txt"

    # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∏—Å–∫–µ
    df -h > "$output_dir/disk-usage.txt"
    du -sh /tmp/rpi-image-gen-* 2>/dev/null >> "$output_dir/disk-usage.txt" || true

    # –õ–æ–≥–∏ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
    find /tmp -name "rpi-image-gen-*" -type d -mtime -1 -exec find {} -name "*.log" \; | head -10 | xargs cp -t "$output_dir/" 2>/dev/null || true

    echo "–î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å–æ–±—Ä–∞–Ω–∞ –≤: $output_dir"
    echo "–î–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–æ–∑–¥–∞–π—Ç–µ –∞—Ä—Ö–∏–≤: tar -czf diagnostic.tar.gz $output_dir"
}
```

### –≠—Ç–∞–ø 2: –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã
```bash
#!/bin/bash
# –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –ø—Ä–æ–±–ª–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π

analyze_extension_issue() {
    local extension_name="$1"
    local issue_type="$2"

    echo "–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã: $issue_type –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è $extension_name"

    case "$issue_type" in
        "dependency")
            echo "=== –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π ==="
            rpi-image-gen layer --describe "$extension_name" --deps

            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∑–∞–≤–∏—Å–∏–º—ã—Ö —Å–ª–æ–µ–≤
            for dep in $(rpi-image-gen layer --list-deps "$extension_name"); do
                if ! rpi-image-gen layer --exists "$dep"; then
                    echo "–û–®–ò–ë–ö–ê: –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞: $dep"
                fi
            done
            ;;

        "variable")
            echo "=== –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö ==="
            rpi-image-gen metadata --lint "layer/${extension_name}.yaml"

            # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
            grep -o 'IGconf_[a-zA-Z_][a-zA-Z0-9_]*' "layer/${extension_name}.yaml" | sort -u | while read -r var; do
                if [[ -z "${!var:-}" ]]; then
                    echo "–ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï: –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è $var –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞"
                fi
            done
            ;;

        "hook")
            echo "=== –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º —Ö—É–∫–æ–≤ ==="
            find . -name "*hook*" -path "*/${extension_name}/*" -type f | while read -r hook; do
                echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ö—É–∫–∞: $hook"
                if ! bash -n "$hook"; then
                    echo "–û–®–ò–ë–ö–ê: –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ $hook"
                fi
            done
            ;;

        "build")
            echo "=== –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º —Å–±–æ—Ä–∫–∏ ==="
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
            du -sh /tmp/rpi-image-gen-* 2>/dev/null || echo "–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"

            # –ê–Ω–∞–ª–∏–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–æ–≥–æ–≤
            find /tmp -name "rpi-image-gen-*" -type d -mtime -1 | head -1 | xargs find -name "*.log" 2>/dev/null | head -5 | xargs tail -50 2>/dev/null || true
            ;;

        *)
            echo "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø –ø—Ä–æ–±–ª–µ–º—ã. –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∏–ø—ã: dependency, variable, hook, build"
            ;;
    esac
}
```

### –≠—Ç–∞–ø 3: –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
```bash
#!/bin/bash
# –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

fix_common_issues() {
    local extension_name="$1"
    local issue_type="$2"

    echo "–ü–æ–ø—ã—Ç–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã: $issue_type"

    case "$issue_type" in
        "dependency")
            echo "–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π..."

            # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
            for dep in $(rpi-image-gen layer --list-deps "$extension_name" 2>/dev/null); do
                if ! rpi-image-gen layer --exists "$dep"; then
                    echo "–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: $dep"
                    # –õ–æ–≥–∏–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
                fi
            done
            ;;

        "permission")
            echo "–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞..."

            # –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤ –Ω–∞ —Ñ–∞–π–ª—ã —Ö—É–∫–æ–≤
            find "layer/${extension_name}" -name "*.sh" -exec chmod +x {} \;

            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
            find "layer/${extension_name}" -name "*.yaml" -exec chmod 644 {} \;
            ;;

        "syntax")
            echo "–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫..."

            # –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫ –≤ bash —Å–∫—Ä–∏–ø—Ç–∞—Ö
            find "layer/${extension_name}" -name "*.sh" -exec sed -i 's/==/=/g' {} \;

            # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ shebang –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
            find "layer/${extension_name}" -name "*.sh" | xargs grep -L "^#!/bin/bash" | xargs sed -i '1i#!/bin/bash'
            ;;

        "cleanup")
            echo "–û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏ –∫—ç—à–∞..."

            # –û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ rpi-image-gen
            rm -rf /tmp/rpi-image-gen-*

            # –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ apt
            apt-get clean

            # –û—á–∏—Å—Ç–∫–∞ Docker –æ–±—Ä–∞–∑–æ–≤ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
            docker system prune -f 2>/dev/null || true
            ;;

        *)
            echo "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è —Ç–∏–ø–∞ '$issue_type' –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ"
            echo "–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä—É—á–Ω–æ–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ"
            ;;
    esac
}
```

## –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è üî¥ –û–í–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ —Ä–∞–∑—Ä–µ—à–∞—é—Ç—Å—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å–ª–æ–µ–≤
**–°–∏–º–ø—Ç–æ–º—ã**: –û—à–∏–±–∫–∞ "Layer not found" –∏–ª–∏ "Dependency resolution failed"
**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–ª–æ–µ–≤
rpi-image-gen layer --list

# –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
rpi-image-gen layer --describe layer-name --deps

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—É—Ç–µ–π –ø–æ–∏—Å–∫–∞
find . -name "*.yaml" -path "*/layer/*" | head -10

# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
echo "# X-Env-Layer-Requires: essential,missing-dependency" >> layer/your-layer.yaml
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
**–°–∏–º–ø—Ç–æ–º—ã**: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ —Ä–∞—Å—à–∏—Ä—è—é—Ç—Å—è –∏–ª–∏ –∏–º–µ—é—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
rpi-image-gen metadata --lint layer.yaml

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
echo "IGconf_extension_test=${IGconf_extension_test}"

# –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∞–≤–∏–ª –≤–∞–ª–∏–¥–∞—Ü–∏–∏
rpi-image-gen layer --describe layer-name --validate-vars

# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ METABEGIN –±–ª–æ–∫–∞
grep -A 20 "^# METABEGIN" layer/your-layer.yaml
```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –≤ —Ö—É–∫–∞—Ö
**–°–∏–º–ø—Ç–æ–º—ã**: –°–∫—Ä–∏–ø—Ç—ã –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π –∏–ª–∏ –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤
bash -n hook-script.sh

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ
uchroot /tmp/test-chroot 'bash -c "your-command"'

# –ê–Ω–∞–ª–∏–∑ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
ls -la /path/to/script.sh

# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
sed -i '1a set -euo pipefail' hook-script.sh
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ
**–°–∏–º–ø—Ç–æ–º—ã**: –°–±–æ—Ä–∫–∞ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è –∏–∑-–∑–∞ –Ω–µ—Ö–≤–∞—Ç–∫–∏ –º–µ—Å—Ç–∞
**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–∏—Å–∫–∞
df -h

# –û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
rm -rf /tmp/rpi-image-gen-*

# –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –ø–∞–∫–µ—Ç–æ–≤
apt-get clean && apt-get autoclean

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ work –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
du -sh work/

# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –º–µ—Å—Ç–∞ –∏–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
echo "–£–º–µ–Ω—å—à–∏—Ç–µ —Ä–∞–∑–º–µ—Ä –æ–±—Ä–∞–∑–∞ –∏–ª–∏ –æ—á–∏—Å—Ç–∏—Ç–µ –¥–∏—Å–∫"
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø–∞–∫–µ—Ç–æ–≤
**–°–∏–º–ø—Ç–æ–º—ã**: –û—à–∏–±–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ø–∞–∫–µ—Ç–æ–≤ –≤–æ –≤—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏
**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
apt-cache depends conflicting-package

# –ê–Ω–∞–ª–∏–∑ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
dpkg -l | grep conflicting

# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤ mmdebstrap —Å–µ–∫—Ü–∏–∏
# –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏—Ö –ø–∞–∫–µ—Ç–æ–≤ –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é
**–°–∏–º–ø—Ç–æ–º—ã**: –û—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–∞–∫–µ—Ç–æ–≤ –∏–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º
**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
ip addr show
ip route show

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ DNS
nslookup deb.debian.org

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∫—Å–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
env | grep -i proxy

# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–∏ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ mirror
echo "–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–µ—Ç–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à"
```

