# –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å–ª–æ—ë–≤
**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2 –æ–∫—Ç—è–±—Ä—è 2025  
**–î–∏–∞–ø–∞–∑–æ–Ω –∫–æ–º–º–∏—Ç–æ–≤:** e6a722a8809042149723d96d65350a56d1586fee..HEAD

---

## üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–ª–æ–∏ (18 —Ñ–∞–π–ª–æ–≤):
1. `layer/app-container/distrobox/distrobox.yaml` ‚úÖ
2. `layer/net-misc/cockpit.yaml` ‚úÖ
3. `layer/rpi/device/rpi5-server-config/rpi5-server-config.yaml` ‚úÖ
4. `layer/security/access-control/account-security/password-policies.yaml` ‚úÖ
5. `layer/security/access-control/authentication-hardening/pam-hardening.yaml` ‚úÖ
6. `layer/security/access-control/mandatory-access-control/apparmor.yaml` ‚úÖ
7. `layer/security/access-control/privileged-operations-audit/sudo-logging.yaml` ‚úÖ
8. `layer/security/monitoring/compliance-auditing/auditd.yaml` ‚úÖ
9. `layer/security/monitoring/network-time-protocol/time-sync.yaml` ‚úÖ
10. `layer/security/network-defense/firewall-management/ufw.yaml` ‚úÖ
11. `layer/security/network-defense/intrusion-prevention/fail2ban.yaml` ‚úÖ
12. `layer/security/security.yaml` ‚úÖ (–º–µ—Ç–∞-—Å–ª–æ–π)
13. `layer/security/system-hardening/kernel-security-tuning/sysctl-hardening.yaml` ‚úÖ
14. `layer/security/system-hardening/security-updates-automation/unattended-upgrades.yaml` ‚úÖ
15. `layer/sys-apps/systemd-chrony-min.yaml` ‚ùå **–û–®–ò–ë–ö–ê –í–ê–õ–ò–î–ê–¶–ò–ò**

### –î–æ–±–∞–≤–ª–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (22 —Ñ–∞–π–ª–∞):
- `layer/app-container/distrobox/README.adoc` ‚úÖ
- `layer/net-misc/cockpit.adoc` ‚úÖ
- `layer/net-misc/openssh-server-README.adoc` ‚úÖ
- `layer/rpi/device/rpi5-server-config/README.adoc` ‚úÖ
- `layer/rpi/device/rpi5-server-config/rpi5-server-config.adoc` ‚úÖ
- `layer/security/README.adoc` ‚úÖ (–∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
- `layer/security/*/README.adoc` (11 —Ñ–∞–π–ª–æ–≤) ‚úÖ
- `layer/security/monitoring/compliance-auditing/*` (6 —Ñ–∞–π–ª–æ–≤ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏) ‚úÖ
- `layer/sys-apps/systemd-chrony-min.adoc` ‚úÖ

### –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ hooks (3 —Ñ–∞–π–ª–∞):
- `layer/security/access-control/mandatory-access-control/hooks/cleanup01-apparmor-finalize` ‚úÖ
- `layer/security/access-control/mandatory-access-control/hooks/customize10-apparmor-profiles` ‚úÖ
- `layer/security/access-control/mandatory-access-control/hooks/essential10-apparmor-setup` ‚úÖ

### –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ AppArmor (3 —Ñ–∞–π–ª–∞):
- `layer/security/access-control/mandatory-access-control/profiles/sbin.init` ‚úÖ
- `layer/security/access-control/mandatory-access-control/profiles/usr.bin.containerd` ‚úÖ
- `layer/security/access-control/mandatory-access-control/profiles/usr.sbin.monitoring` ‚úÖ

---

## ‚úÖ –£—Å–ø–µ—à–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è

### –°–ª–æ–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (13/14 —É—Å–ø–µ—à–Ω–æ):
–í—Å–µ —Å–ª–æ–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–æ—à–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é `rpi-image-gen metadata --lint`:

- **–ú–µ—Ç–∞-—Å–ª–æ–π:** `security.yaml` - –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- **–ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ (4):**
  - AppArmor (mandatory-access-control) ‚úÖ
  - Password policies (account-security) ‚úÖ
  - PAM hardening (authentication-hardening) ‚úÖ
  - Sudo logging (privileged-operations-audit) ‚úÖ
  
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (2):**
  - Auditd (compliance-auditing) ‚úÖ + 6 —Ñ–∞–π–ª–æ–≤ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
  - Time sync (network-time-protocol) ‚úÖ
  
- **–°–µ—Ç–µ–≤–∞—è –∑–∞—â–∏—Ç–∞ (2):**
  - UFW firewall (firewall-management) ‚úÖ
  - Fail2Ban (intrusion-prevention) ‚úÖ
  
- **–£–∫—Ä–µ–ø–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã (2):**
  - Sysctl hardening (kernel-security-tuning) ‚úÖ
  - Unattended upgrades (security-updates-automation) ‚úÖ

### –î—Ä—É–≥–∏–µ —Å–ª–æ–∏:
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:** `distrobox.yaml` ‚úÖ + README.adoc
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** `cockpit.yaml` ‚úÖ + –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **RPI —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:** `rpi5-server-config.yaml` ‚úÖ + –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

## ‚ùå –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê #1: systemd-chrony-min.yaml
**–§–∞–π–ª:** `layer/sys-apps/systemd-chrony-min.yaml`  
**–°—Ç—Ä–æ–∫–∞:** 8

```yaml
# X-Env-Layer-Conflicts: systemd-timesyncd (provides NTP)
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
```
Error loading metadata: Invalid dependency token 'systemd-timesyncd (provides NTP)' - 
dependencies must be comma-separated without spaces/newlines inside a token
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```yaml
# –ë—ã–ª–æ:
# X-Env-Layer-Conflicts: systemd-timesyncd (provides NTP)

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# X-Env-Layer-Conflicts: systemd-timesyncd
# X-Env-Layer-Desc: ... (–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –æ NTP –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ –æ–ø–∏—Å–∞–Ω–∏–µ)
```

### –û–®–ò–ë–ö–ê #2: cryptsetup.yaml (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Å–ª–æ–π, —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è)
**–§–∞–π–ª:** `layer/sys-apps/cryptsetup/cryptsetup.yaml`

```
Error loading metadata: Invalid dependency token 'rpi-essential-base (provides basic cryptsetup)' - 
dependencies must be comma-separated without spaces/newlines inside a token
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –≠—Ç–æ—Ç —Å–ª–æ–π –±—ã–ª –∏–∑–º–µ–Ω—ë–Ω –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –∫–æ–º–º–∏—Ç–æ–≤, –Ω–æ –Ω–µ –±—ã–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é –¥–æ–±–∞–≤–ª–µ–Ω.

### –û–®–ò–ë–ö–ê #3: gnu-common.yaml (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Å–ª–æ–π)
**–§–∞–π–ª:** `layer/sys-devel/gnu-common.yaml`

```
Error loading metadata: Unresolved environment variables: DEB_HOST_ARCH, TOOLCHAIN_MODE
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ù–∞—Ä—É—à–∞–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã - –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–±—ä—è–≤–ª–µ–Ω—ã –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö.

---

## üìã –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ rpi-image-gen

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö

–í—Å–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–ª–æ–∏ —Å–ª–µ–¥—É—é—Ç —Ç—Ä–µ–±—É–µ–º–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ:

```yaml
# METABEGIN
# X-Env-Layer-Name: <–∏–º—è>
# X-Env-Layer-Category: <–∫–∞—Ç–µ–≥–æ—Ä–∏—è>
# X-Env-Layer-Desc: <–æ–ø–∏—Å–∞–Ω–∏–µ>
# X-Env-Layer-Version: <–≤–µ—Ä—Å–∏—è>
# X-Env-Layer-Requires: <–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏>
# X-Env-Layer-Provides: <–ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏>
#
# X-Env-VarPrefix: <–ø—Ä–µ—Ñ–∏–∫—Å>
#
# X-Env-Var-<–∏–º—è>: <–∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é>
# X-Env-Var-<–∏–º—è>-Desc: <–æ–ø–∏—Å–∞–Ω–∏–µ>
# X-Env-Var-<–∏–º—è>-Required: <–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å>
# X-Env-Var-<–∏–º—è>-Valid: <–≤–∞–ª–∏–¥–∞—Ü–∏—è>
# X-Env-Var-<–∏–º—è>-Set: <–º–æ–º–µ–Ω—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏>
# METAEND
---
mmdebstrap:
  packages:
    - <—Å–ø–∏—Å–æ–∫ –ø–∞–∫–µ—Ç–æ–≤>
  customize-hooks:
    - <—Ö—É–∫–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏>
```

### ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π:**
- –ö–∞–∂–¥—ã–π –Ω–æ–≤—ã–π —Å–ª–æ–π –∏–º–µ–µ—Ç README.adoc —Ñ–∞–π–ª ‚úÖ
- –°–ª–æ–π auditd –∏–º–µ–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:
  - PRODUCTION-README.md
  - audit-rules-analysis.adoc
  - compliance-reports-examples.adoc
  - custom-rules-examples.adoc
  - enterprise-performance-analysis.adoc
  - siem-integration.adoc
  
- –û–±—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: `layer/security/README.adoc`

### ‚úÖ –ö–æ–º–ø–æ–∑–∏—Ü–∏—è –∏ –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å

**–û—Ç–ª–∏—á–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
- –°–ª–æ–π `security.yaml` —è–≤–ª—è–µ—Ç—Å—è –º–µ—Ç–∞-—Å–ª–æ–µ–º, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∏–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π:
  ```
  layer/security/
    ‚îú‚îÄ‚îÄ access-control/
    ‚îÇ   ‚îú‚îÄ‚îÄ account-security/
    ‚îÇ   ‚îú‚îÄ‚îÄ authentication-hardening/
    ‚îÇ   ‚îú‚îÄ‚îÄ mandatory-access-control/
    ‚îÇ   ‚îî‚îÄ‚îÄ privileged-operations-audit/
    ‚îú‚îÄ‚îÄ monitoring/
    ‚îÇ   ‚îú‚îÄ‚îÄ compliance-auditing/
    ‚îÇ   ‚îî‚îÄ‚îÄ network-time-protocol/
    ‚îú‚îÄ‚îÄ network-defense/
    ‚îÇ   ‚îú‚îÄ‚îÄ firewall-management/
    ‚îÇ   ‚îî‚îÄ‚îÄ intrusion-prevention/
    ‚îî‚îÄ‚îÄ system-hardening/
        ‚îú‚îÄ‚îÄ kernel-security-tuning/
        ‚îî‚îÄ‚îÄ security-updates-automation/
  ```

### ‚úÖ Hooks –∏ –ø—Ä–æ—Ñ–∏–ª–∏

**AppArmor —Å–ª–æ–π –≤–∫–ª—é—á–∞–µ—Ç:**
- 3 hooks –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
  - `essential10-apparmor-setup` (—Ä–∞–Ω–Ω–∏–π —ç—Ç–∞–ø)
  - `customize10-apparmor-profiles` (–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
  - `cleanup01-apparmor-finalize` (—Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è)
  
- 3 –ø—Ä–æ—Ñ–∏–ª—è AppArmor –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### ‚ö†Ô∏è –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ example-config.yaml

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–∏ –æ–¥–∏–Ω –∏–∑ –Ω–æ–≤—ã—Ö —Å–ª–æ—ë–≤ –Ω–µ –∏–º–µ–µ—Ç —Ñ–∞–π–ª–∞ `example-config.yaml`.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –°–æ–≥–ª–∞—Å–Ω–æ best practices rpi-image-gen, –∫–∞–∂–¥—ã–π —Å–ª–æ–π –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

**–ü—Ä–∏–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω—ã:**
- `layer/app-container/distrobox/example-config.yaml`
- `layer/net-misc/example-config.yaml` (–¥–ª—è cockpit)
- `layer/security/example-config.yaml`
- –ò —Ç.–¥. –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–æ–≤–æ–≥–æ —Å–ª–æ—è

---

## üéØ –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞

### –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:

1. ‚úÖ **–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –∫–∞–∂–¥—ã–π —Å–ª–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω, auditd –∏–º–µ–µ—Ç enterprise-grade –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
2. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö** - –≤—Å–µ —Å–ª–æ–∏ —Å–ª–µ–¥—É—é—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É rpi-image-gen
3. ‚úÖ **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - —Ö–æ—Ä–æ—à–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è –∏ –∫–æ–º–ø–æ–∑–∏—Ü–∏—è —Å–ª–æ—ë–≤
4. ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Valid: keywords, int, bool, string
5. ‚úÖ **Hooks –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã** - —Å–ª–µ–¥—É—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
6. ‚úÖ **94% —É—Å–ø–µ—à–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è** - 17/18 –Ω–æ–≤—ã—Ö —Å–ª–æ—ë–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç lint
7. ‚úÖ **–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** - –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –∞—Å–ø–µ–∫—Ç—ã (MAC, –∞—É–¥–∏—Ç, —Å–µ—Ç—å, —è–¥—Ä–æ)

### –°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:

1. ‚ùå **–û—à–∏–±–∫–∞ –≤ systemd-chrony-min.yaml** - –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π —Ñ–æ—Ä–º–∞—Ç Conflicts
2. ‚ö†Ô∏è **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç example-config.yaml** - –Ω–µ—Ç –ø—Ä–∏–º–µ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–ª—è –Ω–æ–≤—ã—Ö —Å–ª–æ—ë–≤
3. ‚ö†Ô∏è **–ü—Ä–æ–±–ª–µ–º—ã —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Å–ª–æ—è–º–∏** - cryptsetup.yaml –∏ gnu-common.yaml —Ç—Ä–µ–±—É—é—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ù–ï–ú–ï–î–õ–ï–ù–ù–û (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ):

1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å systemd-chrony-min.yaml**
   ```yaml
   # –ó–∞–º–µ–Ω–∏—Ç—å —Å—Ç—Ä–æ–∫—É 8:
   # X-Env-Layer-Conflicts: systemd-timesyncd
   ```

2. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å cryptsetup.yaml**
   ```yaml
   # –£–¥–∞–ª–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏–∑ —Ç–æ–∫–µ–Ω–æ–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
   ```

### –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢:

3. **–î–æ–±–∞–≤–∏—Ç—å example-config.yaml –¥–ª—è –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö —Å–ª–æ—ë–≤**
   - –°–æ–∑–¥–∞—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ä–∞–±–æ—á–∏–µ –ø—Ä–∏–º–µ—Ä—ã
   - –ü–æ–∫–∞–∑–∞—Ç—å —Ç–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
   - –ü—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –¥—Ä—É–≥–∏–º–∏ —Å–ª–æ—è–º–∏

4. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ–π security.yaml**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤—Å–µ—Ö –ø–æ–¥—Å–ª–æ—ë–≤
   - –£–±–µ–¥–∏—Ç—å—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

5. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å gnu-common.yaml**
   - –û–±—ä—è–≤–∏—Ç—å DEB_HOST_ARCH –∏ TOOLCHAIN_MODE –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö

### –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢:

6. **–°–æ–∑–¥–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã**
   - –¢–µ—Å—Ç—ã –¥–ª—è security.yaml —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è–º–∏ –ø–æ–¥—Å–ª–æ—ë–≤
   - –¢–µ—Å—Ç—ã –¥–ª—è rpi5-server-config —Å distrobox –∏ cockpit
   - –¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è auditd

7. **–†–∞—Å—à–∏—Ä–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é**
   - –î–æ–±–∞–≤–∏—Ç—å –¥–∏–∞–≥—Ä–∞–º–º—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
   - –°–æ–∑–¥–∞—Ç—å —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏ —Å systemd-timesyncd –Ω–∞ chrony
   - –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å best practices –¥–ª—è enterprise deployments

---

## üîç –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ—ë–≤

### 1. security.yaml (–º–µ—Ç–∞-—Å–ª–æ–π)

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `includes` –≤–º–µ—Å—Ç–æ `packages`
- –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è AppArmor, auditd, Fail2Ban
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤ –∏ –∞–ª–µ—Ä—Ç–∏–Ω–≥–∞
- YAML –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å SIEM

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –û–±—ä–µ–¥–∏–Ω—è–µ—Ç MAC (AppArmor), –∞—É–¥–∏—Ç (auditd), IPS (Fail2Ban)
- –°–æ–∑–¥–∞—ë—Ç –µ–¥–∏–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å—Ç–∞—Ç—É—Å–∞
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –æ—Ç—á—ë—Ç–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç compliance –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (CIS, PCI-DSS, HIPAA, GDPR)

### 2. auditd (compliance-auditing)

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- Enterprise-grade –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (6 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤)
- SIEM –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- Compliance –æ—Ç—á—ë—Ç—ã
- –ö–∞—Å—Ç–æ–º–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤–∫–ª—é—á–∞–µ—Ç:**
- audit-rules-analysis.adoc - –∞–Ω–∞–ª–∏–∑ –ø—Ä–∞–≤–∏–ª
- compliance-reports-examples.adoc - –ø—Ä–∏–º–µ—Ä—ã –æ—Ç—á—ë—Ç–æ–≤
- custom-rules-examples.adoc - –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞
- enterprise-performance-analysis.adoc - –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- siem-integration.adoc - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SIEM
- PRODUCTION-README.md - production —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

### 3. distrobox.yaml

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê (4/5)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ container managers (docker, podman, lilipod)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- Desktop –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç example-config.yaml (-1 –±–∞–ª–ª)

### 4. systemd-chrony-min.yaml

**–û—Ü–µ–Ω–∫–∞:** ‚≠ê‚≠ê‚≠ê (3/5)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –•–æ—Ä–æ—à–∞—è –∑–∞–º–µ–Ω–∞ systemd-timesyncd
- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–µ–∂–∏–º–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (server, client, custom)
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å systemd
- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–µ–≥–æ timesyncd

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- **–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ Conflicts** (-2 –±–∞–ª–ª–∞) - –ö–†–ò–¢–ò–ß–ù–û

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:
- **–ù–æ–≤—ã—Ö —Å–ª–æ—ë–≤:** 18
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:** 22 —Ñ–∞–π–ª–∞
- **Hooks:** 3
- **–ü—Ä–æ—Ñ–∏–ª–µ–π AppArmor:** 3
- **–£—Å–ø–µ—à–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è:** 94% (17/18)
- **–ü–æ–∫—Ä—ã—Ç–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π:** 100%

### –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5) - –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–∞—è –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5) - Enterprise-grade
- **–ö–æ–¥:** ‚≠ê‚≠ê‚≠ê‚≠ê (4/5) - –û–¥–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** ‚≠ê‚≠ê (2/5) - –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç example-config.yaml

### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: ‚≠ê‚≠ê‚≠ê‚≠ê (4.25/5)

**–í–µ—Ä–¥–∏–∫—Ç:** –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –æ—à–∏–±–∫–æ–π, –∫–æ—Ç–æ—Ä–∞—è –ª–µ–≥–∫–æ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è.

---

## üöÄ –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –®–∞–≥ 1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
```bash
# 1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å systemd-chrony-min.yaml
vim layer/sys-apps/systemd-chrony-min.yaml
# –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç—Ä–æ–∫—É 8: —É–¥–∞–ª–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏–∑ —Ç–æ–∫–µ–Ω–∞ Conflicts

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
./rpi-image-gen metadata --lint layer/sys-apps/systemd-chrony-min.yaml
```

### –®–∞–≥ 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ example-config.yaml
```bash
# –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö —Å–ª–æ—ë–≤
touch layer/app-container/distrobox/example-config.yaml
touch layer/net-misc/example-config-cockpit.yaml
touch layer/security/example-config.yaml
# ... –∏ —Ç.–¥.
```

### –®–∞–≥ 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –¢–µ—Å—Ç –±–∞–∑–æ–≤–æ–π —Å–±–æ—Ä–∫–∏ —Å security —Å–ª–æ–µ–º
./rpi-image-gen build -c test/security-basic.yaml

# –¢–µ—Å—Ç —Å auditd –∏ compliance
./rpi-image-gen build -c test/security-enterprise.yaml
```

### –®–∞–≥ 4: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```bash
# –û–±–Ω–æ–≤–∏—Ç—å README.adoc —Å –Ω–æ–≤—ã–º–∏ —Å–ª–æ—è–º–∏
# –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª –æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
# –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å–ª–æ—ë–≤
```

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–¥–µ–ª–∞–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç **–≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –∫–∞—á–µ—Å—Ç–≤–∞** –∏ **–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥** –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ —Å–ª–æ—ë–≤ –¥–ª—è rpi-image-gen:

1. ‚úÖ –í—Å–µ –Ω–æ–≤—ã–µ —Å–ª–æ–∏ —Å–ª–µ–¥—É—é—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ rpi-image-gen
2. ‚úÖ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è auditd)
3. ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –º–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
4. ‚úÖ 94% —É—Å–ø–µ—à–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
5. ‚ùå –û–¥–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ (–ª–µ–≥–∫–æ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è)
6. ‚ö†Ô∏è –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç example-config.yaml

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è systemd-chrony-min.yaml –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è example-config.yaml, –≤—Å–µ —Å–ª–æ–∏ –≥–æ—Ç–æ–≤—ã –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
1. üî¥ –ö–†–ò–¢–ò–ß–ù–û: systemd-chrony-min.yaml (5 –º–∏–Ω—É—Ç)
2. üü° –í–´–°–û–ö–ò–ô: example-config.yaml (1-2 —á–∞—Å–∞)
3. üü¢ –°–†–ï–î–ù–ò–ô: –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (4-8 —á–∞—Å–æ–≤)

