# Переменные окружения для полной конфигурации системы
# Используются с: rpi-image-gen build -c config/complete-system.yaml -- [переменные]

# ============================================================================
# СИСТЕМНЫЕ НАСТРОЙКИ
# ============================================================================

# APT key directory for Docker and other repositories
IGconf_sys_apt_keydir=/usr/share/keyrings

# AppArmor - режим enforce для максимальной безопасности
IGconf_apparmor_core_mode=enforce
IGconf_apparmor_core_auditd_integration=y
IGconf_apparmor_core_desktop_notifications=n

# Auditd - подробный аудит системы
IGconf_auditd_core_buffer_size=8192
IGconf_auditd_core_max_log_file=8
IGconf_auditd_core_failure_mode=1
IGconf_auditd_core_kernel_auditing=y

# Sysctl hardening - защита ядра и сети
IGconf_sysctl_hardening_kernel_kptr_restrict=0
IGconf_sysctl_hardening_security_ip_forward=0
IGconf_sysctl_hardening_network_rp_filter=1
IGconf_sysctl_hardening_performance_swappiness=10

# Firewall (UFW) - restrictive политика
IGconf_ufw_core_default_input_policy=DROP
IGconf_ufw_core_default_output_policy=ACCEPT
IGconf_ufw_core_default_forward_policy=DROP
IGconf_ufw_core_ipv6_enabled=true
IGconf_ufw_core_logging_level=low

# ============================================================================
# АУТЕНТИФИКАЦИЯ И ПАРОЛИ
# ============================================================================

# Password policies - строгие требования
IGconf_password_policies_core_minlen=12
IGconf_password_policies_core_ucredit=-1
IGconf_password_policies_core_lcredit=-1
IGconf_password_policies_core_dcredit=-1
IGconf_password_policies_core_ocredit=-1

# PAM - блокировка аккаунтов
IGconf_pam_core_password_minlen=12
IGconf_pam_core_account_lockout_attempts=5
IGconf_pam_core_account_lockout_time=900

# Fail2ban - защита от brute-force
IGconf_fail2ban_core_log_target=/var/log/fail2ban.log
IGconf_fail2ban_core_log_level=INFO
IGconf_fail2ban_core_db_file=/var/lib/fail2ban/fail2ban.db

# ============================================================================
# ГИБРИДНОЕ ХРАНИЛИЩЕ (RAID1 + LUKS)
# ============================================================================

# Включение шифрования и RAID
IGconf_hybrid_raid_luks_encryption_enabled=y
IGconf_hybrid_raid_luks_rootfs_type=ext4
IGconf_hybrid_raid_luks_ssd_devices="/dev/sda,/dev/sdb"
IGconf_hybrid_raid_luks_boot_part_size=200M
IGconf_hybrid_raid_luks_root_part_size=8G
IGconf_hybrid_raid_luks_key_size=512
IGconf_hybrid_raid_luks_disk_expansion_enabled=y

# ============================================================================
# КОНТЕЙНЕРИЗАЦИЯ (Distrobox)
# ============================================================================

IGconf_app_container_distrobox_enable=y
IGconf_app_container_distrobox_container_name=development
IGconf_app_container_distrobox_image=ubuntu:22.04
IGconf_app_container_distrobox_home=/home/user
IGconf_app_container_distrobox_additional_packages="git,vim,build-essential"

# ============================================================================
# СЕТЕВОЕ УПРАВЛЕНИЕ (Cockpit)
# ============================================================================

IGconf_net_misc_cockpit_enable=y
IGconf_net_misc_cockpit_port=9090
IGconf_net_misc_cockpit_ssl=true
IGconf_net_misc_cockpit_allow_unencrypted=false

# ============================================================================
# ОПТИМИЗАЦИИ УСТРОЙСТВ
# ============================================================================

# Raspberry Pi 5 - серверные оптимизации
IGconf_rpi5_server_disable_hdmi=y
IGconf_rpi5_server_disable_wifi=y
IGconf_rpi5_server_disable_bluetooth=y
IGconf_rpi5_server_disable_audio=y
IGconf_rpi5_server_pcie_max_speed=y
IGconf_rpi5_server_usb_max_performance=y
IGconf_rpi5_server_disable_unused_interfaces=y

# Radxa SATA HAT - поддержка SATA контроллера
IGconf_radxa_sata_initramfs_sata=y
IGconf_radxa_sata_pcie_gen3=y
IGconf_radxa_sata_sata_power_control=y
IGconf_radxa_sata_gpio_pin=26
IGconf_radxa_sata_power_on_delay=2
IGconf_radxa_sata_power_off_delay=1
