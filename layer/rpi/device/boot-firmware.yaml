# METABEGIN
# X-Env-Layer-Name: rpi-boot-firmware
# X-Env-Layer-Category: firmware
# X-Env-Layer-Desc: Raspberry Pi boot firmware for all devices
# X-Env-Layer-Version: 1.0.0
#
# X-Env-VarRequires: RPI_TEMPLATES
# X-Env-VarRequires-Valid: string
# METAEND
---
mmdebstrap:
  packages:
    - raspi-firmware
  customize-hooks:
    - mkdir -p $1/boot/firmware
    - ln -sf firmware/overlays $1/boot/overlays
    - install -m 644 $RPI_TEMPLATES/boot-firmware/cmdline.txt $1/boot/firmware/
    - install -m 644 $RPI_TEMPLATES/boot-firmware/config.txt $1/boot/firmware/
    - for f in cmdline.txt config.txt; do
      printf "DO NOT EDIT THIS FILE\n\nThe file you are looking for has moved to %s\n" /boot/firmware/$f > $1/boot/$f;
      done
