# Каталог bin/ - Исполняемые файлы

Каталог содержит исполняемые файлы и утилиты проекта rpi-image-gen.

## Основные компоненты

### `ig` (Python)
**Назначение**: Основной Python-движок проекта
**Функции**:
- Загружает модули из каталога `site/`
- Обрабатывает команды: config, metadata, layer
- Использует argparse для разбора параметров командной строки
- Вызывает соответствующие обработчики для каждой команды

### `igconf` (Bash)
**Назначение**: Вспомогательный инструмент для работы с конфигурацией
**Функции**:
- Предоставляет функции для проверки переменных конфигурации
- Поддерживает операции: isset, isnset, isy, isn, isval, getval
- Может использоваться как библиотека или исполняемый файл
- Работает с переменными префикса IGconf_

### `runner` (Bash)
**Назначение**: Исполнитель скриптов сборки
**Функции**:
- Выполняет скрипты на различных этапах сборки bdebstrap
- Этапы: setup, extract, essential, customize, cleanup
- Ищет скрипты в заданных каталогах в определенном порядке
- Выполняет скрипты с соответствующими параметрами

### `mkslot-helper` (Bash)
**Назначение**: Вспомогательная утилита для работы с разделами
**Функции**: Создание и управление разделами дисков

### `uchroot` (Bash)
**Назначение**: Утилита для работы с chroot окружением
**Функции**: Безопасная работа с chroot для сборки

### `pmap` (Bash)
**Назначение**: Утилита для сопоставления путей
**Функции**: Управление путевыми сопоставлениями

### `image2json` (Bash)
**Назначение**: Конвертер образов в JSON формат
**Функции**: Преобразование дисковых образов в JSON

### `idp.sh` (Bash)
**Назначение**: Скрипт для работы с зависимостями
**Функции**: Управление зависимостями проекта

## Использование

Исполняемые файлы используются системой сборки в процессе создания образов Raspberry Pi:

1. `ig` - основная точка входа для Python-компонентов
2. `runner` - выполняет пользовательские скрипты на этапах сборки
3. `igconf` - проверяет и получает значения конфигурации
4. Остальные утилиты используются для специализированных задач

## Доступные шаблоны

### `bash-script-template.md` (в lib/)
Шаблон для создания исполняемых Bash скриптов с полной структурой:
- Функции логирования с цветным выводом
- Парсинг аргументов командной строки
- Валидация зависимостей и входных данных
- Обработка ошибок и очистка ресурсов
- Строгий режим выполнения (set -euo pipefail)

Используйте: `cp ../lib/bash-script-template.md my-script.sh`

### `python-script-template.md`
Шаблон для создания исполняемых Python скриптов:
- Стандартная структура Python приложения
- Обработка аргументов через argparse
- Логирование и обработка ошибок
- Интеграция с системой rpi-image-gen
- Совместимость с CLI интерфейсом

## Создание нового скрипта

### Bash скрипт
1. **Создайте файл скрипта** на основе шаблона:
   ```bash
   cp ../lib/bash-script-template.md bin/my-script.sh
   chmod +x bin/my-script.sh
   ```
2. **Настройте параметры** скрипта (имя, описание, аргументы)
3. **Реализуйте основную логику** в функции `run_main_logic()`
4. **Протестируйте скрипт**:
   ```bash
   ./bin/my-script.sh --help
   ```

### Python скрипт
1. **Создайте файл скрипта** на основе шаблона:
   ```bash
   cp scheme/bin/python-script-template.md bin/my-tool.py
   chmod +x bin/my-tool.py
   ```
2. **Настройте класс** `[ClassName]` для вашей логики
3. **Обновите парсинг аргументов** в функции `parse_arguments()`
4. **Протестируйте скрипт**:
   ```bash
   python3 bin/my-tool.py --help
   ```
